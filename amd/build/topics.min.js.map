{"version":3,"sources":["../src/topics.js"],"names":["init","cmid","registerEventListeners","deletebtns","document","querySelectorAll","forEach","btn","topic","closest","topicid","getAttribute","topictitel","addEventListener","deletetopic","editbtns","edit","edittopic","getElementById","savenewtopic","key","component","param","then","strings","Notification","confirm","Ajax","call","methodname","args","done","parentElement","remove","fail","exception","catch","classList","add","value","focus","window","event","keyCode","newtopicname","innerHTML","setAttribute","newtopic","goTo","location","pathname","href"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nimport 'core/inplace_editable';\nimport Notification from 'core/notification';\nimport Ajax from 'core/ajax';\nimport {\n    get_strings as getStrings,\n} from 'core/str';\n\nexport const init = (cmid) => {\n        registerEventListeners(cmid);\n};\n\nfunction registerEventListeners(cmid) {\n\n    const deletebtns = document.querySelectorAll('#cardbox-topics .cardbox-edittopics-delete-button');\n    deletebtns.forEach(btn => {\n        const topic = btn.closest('#cardbox-topic-in-review');\n        const topicid = topic.getAttribute('data-topicid');\n        const topictitel = topic.getAttribute('data-titel');\n        btn.addEventListener('click', () => {\n            deletetopic(cmid, topicid, topictitel);\n        });\n    });\n\n    const editbtns = document.querySelectorAll('#cardbox-topics .cardbox-edittopics-edit-button');\n    editbtns.forEach(btn => {\n        const edit = btn.closest('#cardbox-topic-in-review');\n        const topicid = edit.getAttribute('data-topicid');\n\n        btn.addEventListener('click', () => {\n            const topictitel = edit.getAttribute('data-titel');\n            edittopic(cmid, topicid, topictitel);\n        });\n    });\n\n    document.getElementById(\"cardbox-submit-new-topic\").addEventListener('click', () => {\n        savenewtopic(cmid);\n    });\n}\n\nfunction deletetopic(cmid, topicid, topictitel) {\n    getStrings([\n        {key: 'deletetopic', component: 'cardbox'},\n        {key: 'deletetopicinfo', component: 'cardbox', param: \"'\" + topictitel + \"'\"},\n        {key: 'yes'},\n        {key: 'cancel'}\n    ])\n    .then(strings => {\n        Notification.confirm(strings[0], strings[1], strings[2], strings[3], () => {\n            Ajax.call([{\n                methodname:'mod_cardbox_deletetopic',\n                args: {\n                    'topicid': topicid,\n                },\n                done: () => {\n                    document.getElementById(\"cardbox-topic-\"+topicid).parentElement.parentElement.remove();\n                },\n                fail: Notification.exception\n            }]);\n        });\n    }).catch(Notification.exception);\n}\n\nfunction edittopic(cmid, topicid, topictitel) {\n\n    document.getElementById(\"cardbox-topic-\"+topicid).classList.add('displaynone');\n    document.getElementById(\"cardbox-topic-rename-\"+topicid).classList.remove('displaynone');\n    document.getElementById(\"cardbox-changedtopic-\"+topicid).value = topictitel;\n    document.getElementById(\"cardbox-changedtopic-\"+topicid).focus();\n    document.getElementById(\"cardbox-topic-rename-\"+topicid).addEventListener('keydown', () => {\n        if (window.event.keyCode == 13) {\n            var newtopicname = document.getElementById(\"cardbox-changedtopic-\"+topicid).value;\n            if (newtopicname != topictitel){\n                Ajax.call([{\n                    methodname:'mod_cardbox_renametopic',\n                    args: {\n                        'topicid': topicid,\n                        'newtopicname': newtopicname,\n                    },\n                    done: () => {\n                        document.getElementById(\"topictitel-\"+topicid).innerHTML = newtopicname;\n                        document.getElementById(\"cardbox-topic-\"+topicid).parentElement.setAttribute('data-titel', newtopicname);\n                    },\n                    fail: Notification.exception\n                }]);\n            }\n            document.getElementById(\"cardbox-topic-\"+topicid).classList.remove('displaynone');\n            document.getElementById(\"cardbox-topic-rename-\"+topicid).classList.add('displaynone');\n        }\n        if (window.event.keyCode == 27) {\n            document.getElementById(\"cardbox-topic-\"+topicid).classList.remove('displaynone');\n            document.getElementById(\"cardbox-topic-rename-\"+topicid).classList.add('displaynone');\n        }\n    });\n    document.getElementById(\"cardbox-changedtopic-\"+topicid).addEventListener('blur', () => {\n        document.getElementById(\"cardbox-topic-\"+topicid).classList.remove('displaynone');\n        document.getElementById(\"cardbox-topic-rename-\"+topicid).classList.add('displaynone');\n    });\n\n}\n\nfunction savenewtopic (cmid) {\n    var newtopic = document.getElementById(\"create-new-topic\").value;\n    if (newtopic != \"\") {\n        var goTo = window.location.pathname + '?id=' + cmid + '&action=savenewtopic&newtopic=' + newtopic;\n        window.location.href = goTo;\n    }\n}"],"file":"topics.min.js"}